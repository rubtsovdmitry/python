import sys, bext


GOAL = 4                                                                                                                         # —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –≤–µ–¥—Ä–µ, —á—Ç–æ–±—ã –≤—ã–∏–≥—Ä–∞—Ç—å
steps = 0                                                                                                                        # —Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ —Å–¥–µ–ª–∞–ª –∏–≥—Ä–æ–∫, —á—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É

waterInBucket = {'8': 0, '5': 0, '3': 0}                                                                                         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã –≤ –∫–∞–∂–¥–æ–º –≤–µ–¥—Ä–µ

bext.clear()
width, height = bext.size()
bext.goto(0, int(height / 3))
bext.fg("purple")

"""–æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∏–≥—Ä—ã"""
while True:  
    """–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—ë–¥–µ—Ä"""
    print()
    print('–ù—É–∂–Ω–æ –Ω–∞–±—Ä–∞—Ç—å —Ä–æ–≤–Ω–æ ' + str(GOAL) + ' –ª–∏—Ç—Ä–∞ –≤–æ–¥—ã –≤ –æ–¥–Ω–æ –∏–∑ –≤—ë–¥–µ—Ä.\n')
    print('–í—ë–¥—Ä–∞:')

    waterDisplay = []                                                                                                            # –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –≤–æ–¥—ã –∏–ª–∏ –ø—É—Å—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

    """–ø–æ–ª—É—á–∏–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤–æ—Å—å–º–∏–ª–∏—Ç—Ä–æ–≤–æ–≥–æ –≤–µ–¥—Ä–∞"""
    for i in range(1, 9):                                                                                                        
        if waterInBucket['8'] < i:
            waterDisplay.append('      ')                                                                                        # –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ–¥—Ä–æ –ø—Ä–æ–±–µ–ª–∞–º–∏ (–ø—É—Å—Ç–æ—Ç–∞)
        else:
            waterDisplay.append('üü¶üü¶üü¶')                                                                                        # –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ–¥—Ä–æ —Å–∏–Ω–∏–º–∏ –∫–≤–∞–¥—Ä–∞—Ç–∞–º–∏ (–≤–æ–¥–∞)

    """–ø–æ–ª—É—á–∏–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–æ–≥–æ –≤–µ–¥—Ä–∞"""
    for i in range(1, 6):
        if waterInBucket['5'] < i:
            waterDisplay.append('      ')  
        else:
            waterDisplay.append('üü¶üü¶üü¶')  

    """–ø–æ–ª—É—á–∏–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ç—Ä—ë—Ö–ª–∏—Ç—Ä–æ–≤–æ–≥–æ –≤–µ–¥—Ä–∞"""
    for i in range(1, 4):
        if waterInBucket['3'] < i:
            waterDisplay.append('      ')  
        else:
            waterDisplay.append('üü¶üü¶üü¶')  

    """–æ—Ç–æ–±—Ä–∞–∑–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≤—ë–¥—Ä–∞, –∫–∞–∂–¥–æ–µ —Å–æ —Å–≤–æ–∏–º –æ–±—ä—ë–º–æ–º –≤–æ–¥—ã"""
    print('''
8|{7}|
7|{6}|
6|{5}|
5|{4}|  5|{12}|
4|{3}|  4|{11}|
3|{2}|  3|{10}|  3|{15}|
2|{1}|  2|{9}|  2|{14}|
1|{0}|  1|{8}|  1|{13}|
 +------+   +------+   +------+
    8–ª         5–ª         3–ª
'''.format(*waterDisplay))                                                                                                       # —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é waterDisplay –Ω–∞ –ª–µ—Ç—É –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –≤—Å—ë –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö

    """–ø—Ä–æ–≤–µ—Ä–∏–º –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ª–∏ –≤ –≤—ë–¥—Ä–∞—Ö –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ–¥—ã"""
    for waterAmount in waterInBucket.values():
        if waterAmount == GOAL:
            print(f'–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã —Ä–µ—à–∏–ª–∏ —ç—Ç—É –∑–∞–¥–∞—á—É –∑–∞ {steps} —à–∞–≥–æ–≤!')
            sys.exit()

    """–≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ —Å–æ–≤–µ—Ä—à–∏—Ç—å"""
    print('–ö–∞–∫–∏–µ –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è:')
    print('  (–ù)–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ–¥—Ä–æ')
    print('  (–í)—ã–ª–∏—Ç—å –≤–µ–¥—Ä–æ')
    print('  (–ü)–µ—Ä–µ–ª–µ–π—Ç–µ –æ–¥–Ω–æ –≤–µ–¥—Ä–æ –≤ –¥—Ä—É–≥–æ–µ')
    print('  (–ó)–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É')

    """—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–≤–µ–¥—ë—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ—Ç–≤–µ—Ç –æ –¥–µ–π—Å—Ç–≤–∏–∏"""
    while True:  
        move = input('> ').upper()
        if move == '–ó':
            print('–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É!')
            sys.exit()

        if move in ('–ù', '–í', '–ü'):
            break
        print('–í—ã –≤–≤–µ–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –í–≤–µ–¥–∏—Ç–µ: "–ù", "–í", "–ü" –∏–ª–∏ "–ó"')

    """—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–≤–µ–¥—ë—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ—Ç–≤–µ—Ç, –∫–∞–∫–æ–µ –≤–µ–¥—Ä–æ"""
    while True:  
        print('–í—ã–±—Ä–∞—Ç—å –≤–µ–¥—Ä–æ: 8, 5, 3, –∏–ª–∏ (–ó)–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É.')
        srcBucket = input('> ').upper()

        if srcBucket == '–ó':
            print('–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É!')
            sys.exit()

        if srcBucket in ('8', '5', '3'):
            break 

    """–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ"""
    if move == '–ù':
        # –ù–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ–¥—Ä–æ –ø–æ –º–∞–∫—Å–∏–º—É–º—É
        srcBucketSize = int(srcBucket)
        waterInBucket[srcBucket] = srcBucketSize
        steps += 1

    elif move == '–í':
        # –í—ã–ª–∏—Ç—å –≤–µ–¥—Ä–æ
        waterInBucket[srcBucket] = 0
        steps += 1

    elif move == '–ü':
        # –ü–µ—Ä–µ–ª–∏—Ç—å –≤–æ–¥—É –≤ –¥—Ä—É–≥–æ–µ –≤–µ–¥—Ä–æ
        while True:  
            print('–í—ã–±–∏—Ä–µ—Ç–µ –≤–µ–¥—Ä–æ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–ª–∏–≤–∞–µ–º: 8, 5, or 3')
            dstBucket = input('> ').upper()
            if dstBucket in ('8', '5', '3'):
                break  

        # –û–ø—Ä–µ–¥–µ–ª–∏–º –Ω–∞–ª–∏–≤–∞–µ–º—ã–π –æ–±—ä—ë–º –≤–æ–¥—ã
        dstBucketSize = int(dstBucket)                                          # –ø–æ–ª–Ω—ã–π –æ–±—ä—ë–º –≤–æ–¥—ã –≤–µ–¥—Ä–∞, –≤ –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–ª–∏–≤–∞–µ–º
        emptySpaceInDstBucket = dstBucketSize - waterInBucket[dstBucket]        # –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –æ–±—ä—ë–º –≤–æ–¥—ã –≤ –≤–µ–¥—Ä–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–ª–∏–≤–∞–µ–º
        waterInSrcBucket = waterInBucket[srcBucket]                             # –æ–±—ä—ë–º –≤–æ–¥—ã –≤ –≤–µ–¥—Ä–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–µ—Ä–µ–ª–∏–≤–∞–µ–º
        amountToPour = min(emptySpaceInDstBucket, waterInSrcBucket)             # –æ–±—ä—ë–º –≤–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –¥–æ–ª–∏—Ç—å –≤–µ–¥—Ä–æ

        # –í—ã–ª–∏–≤–∞–µ–º –≤–æ–¥—É –∏–∑ –≤–µ–¥—Ä–∞
        waterInBucket[srcBucket] -= amountToPour

        # –ù–∞–ª–∏—ã–≤–µ–º –≤—ã–ª–∏—Ç—É—é –≤–æ–¥—É –≤ –¥—Ä—É–≥–æ–µ –≤–µ–¥—Ä–æ
        waterInBucket[dstBucket] += amountToPour
        steps += 1